{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","defined","value","UNDEFINED","round","precision","power","pow","math","p","limitValue","min","max","rad","degrees","DEG_TO_RAD","deg","radians","isNumber","val","isNaN","valueOrDefault","defaultValue","sqr","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","hashObject","arrayLimits","arr","MAX_NUM","MIN_NUM","arrayMin","arrayMax","sparseArrayMin","sparseArrayLimits","sparseArrayMax","n","isFinite","undefined","last","array","append","first","second","apply","renderTemplate","text","template","useWithBlock","paramName","renderAttr","name","renderAllAttr","attrs","output","renderStyle","renderSize","size","renderPos","pos","result","toHyphens","split","isTransparent","color","arabicToRoman","literals",1,10,100,2,20,200,3,30,300,4,40,400,5,50,500,6,60,600,7,70,700,8,80,800,9,90,900,1000,"values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","ucs2decode","string","extra","counter","ucs2encode","map","String","fromCharCode","Math","window","PI","Number","MAX_VALUE","now","Date","getTime","drawing","dataviz","$","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","loadFonts","fonts","callback","promises","document","font","load","e","logToConsole","Promise","all","then","doc","Class","LRUCache","_size","_length","_map","put","lru","entry","_head","_tail","newer","older","get","defaultMeasureBox","_cache","_initOptions","baselineMarkerSize","box","styleKey","cacheKey","cachedResult","baselineMarker","_baselineMarker","cloneNode","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","jQuery","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","ENTITIES","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","amp","lt","gt","quot","apos","nbsp","parseXML","ex","encodeBase64","input","chr1","chr2","chr3","enc1","enc2","enc3","enc4","encodeUTF8","KEY_STR","inArray","ObserversMixin","observers","_observers","addObserver","element","removeObserver","splice","methodName","event","observer","idx","_suspended","optionsChange","geometryChange","suspend","resume","_observerField","field","mixins","copyToClipboard","html","textarea","createElement","addClass","appendTo","focus","select","execCommand","remove","Command","TargetValueCommand","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","exec","setState","getState","state","_forEachCell","ref","_ref","forEach","sheet","toRangeRef","bind","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_hasSetValue","GridLinesChangeCommand","showGridLines","prototype","skipHiddenCells","enable","ClearContentCommand","clearContent","EditCommand","rejectState","validationState","title","message","reason","type","_getValidationState","ex1","calc","ParseError","ex2","TextWrapCommand","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_decimals","decimals","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","noBorders","borderLeft","borderTop","borderRight","borderBottom","allBorders","leftBorder","leftColumn","rightBorder","rightColumn","topBorder","topRow","bottomBorder","bottomRow","outsideBorders","insideBorders","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","activeSheet","pasteRef","status","canPaste","menuInvoked","paste","_adjustRowHeight","pasteOnMerged","overflow","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","_view","CopyCommand","noop","canCopy","copy","multiSelection","ToolbarCopyCommand","CutCommand","cut","AutoFillCommand","origin","_origin","fillFrom","Range","FillError","ToolbarCutCommand","FilterCommand","filter","hasFilter","intersectingMerged","SortCommand","column","ascending","expandRange","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteRowCommand","deleteSelectedRows","DeleteColumnCommand","deleteSelectedColumns","AddColumnCommand","addColumnLeft","addColumnRight","AddRowCommand","canAddRow","addRowAbove","addRowBelow","EditValidationCommand","validation","OpenCommand","file","match","fromFile","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","ch","isCloseParen","isMatchingParen","close","open","touches","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper",27,37,39,35,36,32,"attr","css","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","filterOperator","scalePadding","minLength","enableEditing","toggleClass","removeAttr","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","currentRange","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","test","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","preventDefault","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","replace","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_focusTimeout","pressed","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_sync","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","top","left","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","operator","hide","rectangle","resize","canInsertRef","isKeyboardAction","_canInsertRef","afterPoint","canReplace","canInsertBetween","right","strictMode","refAtPoint","simplify","newValue","rest","substr","syncWith","iehandler","self","eventName","handler","off","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","insertNewline","eof","Mac","isAlphaNum","keyName","EventListener",13,38,33,34,46,113,"navigator","platform","indexOf","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","altKey","shiftKey","passThrough","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","clone","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","unique","at","lastRangeStart","ValueRange","toExcelFormat","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","validations","dateToNumber","culture","calendar","patterns","PropertyBag","specs","sortable","serializable","depends","cellCount","properties","lists","spec","fromJSON","si","iterators","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","setSheet","absolute","relative","adjust","toString","print","obj","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","display","ret","trow","tcol","abs","arow","acol","forRow","delta","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","bottom","move","cols","tr","u","reduce","empty","theRef","newRefs","NULLREF","SHEETREF","Infinity","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","selection","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_sheet","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","currentNavigationRange","selTopLeft","selBottomRight","done","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","forEachMergedCell","merged","hint","preview","props","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","layout","recalc","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","deleteColumn","deleteRow","hasRight","hasLeft","hideColumn","_count","isHiddenColumn","hasBottom","hasTop","hideRow","isHiddenRow","unhideColumn","unhideRow","insertColumn","rowCount","canInsertRow","insertRow","newState","mergedCells","foreign","origRef","setStateData","getSourceRef","stripStyle","borderObject","cellState","getComputedStyle","borders","fontSize","background","underline","italic","bold","textAlign","verticalAlign","wrap","parseHTML","tbody","find","each","td","ci","ri","rowspan","colspan","blankCell","after","address","parseTSV","Clipboard","iframe","className","_external","_uid","guid","external","isExternal","intersectsMerged","contents","plain","destination","originActiveCell","rowDelta","colDelta","_isInternal","triggerChange","table","contentWindow","write","internalHTML","internalPlain","partition","predicate","looksLikeANumber","getTextHeight","font-size","word-break","white-space","PROPERTIES","complement","skipHiddenRows","skipHiddenCols","add","_normalize","_set","noTrigger","_get","_resizedRef","_border","_collapsedBorder","collapsedBorderTop","collapsedBorderRight","collapsedBorderBottom","collapsedBorderLeft","formula","t1","t2","existingFormat","compile","editorChange","isInEditMode","numberToDate","_","__","toJSON","_validation","_merge","mergedRef","vi","_properties","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","clearFormat","isSortable","_sortBy","isFilterable","clearFilters","_filterBy","_filter","propertyName","dr","dc","maxHeight","cellRange","totalWidth","hasValue","flag","draw","CalcError","argmax","compileArgumentChecks","functionName","args","comp","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","forceNum","err","main","Function","withErrorHandling","makeSyncFunction","check","doit","xargs","Matrix","arrays","makeAsyncFunction","count","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","binaryCompare","exports","Context","Formula","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","getRefData","_resolve","error","onFormula","fetch","context","pending","formulas","getRefCells","cellValues","fname","bool","asMatrix","h","isRange","hiddenInfo","getData","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","lcsheet","parentContext","reset","renameSheet","oldSheetName","newSheetName","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","co","th","comatrix","thmatrix","elmatrix","defineAlias","alias","orig","kendoSpreadsheetAliases","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","allowNulls","_getListData","Validation","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","_getOptions","compareValue","compareFormat","calculateFromCallBack","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","_reinit","columnCount","headerHeight","headerWidth","Axis","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","_selectionState","_inEdit","_navigator","_axisManager","_name","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","_adjustReferences","_sheets","_forFormulas","_forValidations","adjustNames","nextRef","isEnabledRow","isEnabledColumn","numRows","numColumns","parseReference","forEachFilterHeader","columnRef","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","activeCellSelection","selectedHeaders","allCols","allRows","rowSelection","colSelection","rowState","colState","isInEdit","_setFormulaSelections","_viewActiveCell","json","positions","viewSelection","hyperlinks","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","_refresh","cellRefIndex","resetFormulas","resetValidations","next","revalidate","cellRef","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","sheetsWrapper","scrollPrevButton","scrollNextButton","gapWidth","addButton","addButtonWidth","scrollPrevButtonWidth","sheetsGroup","scrollNextButtonRight","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","children","outerWidth","_sheetsGroup","marginLeft","scrollWidth","ceil","parseFloat","_scrollableModeActive","_nowScrollingSheets","marginRight","_toggleScrollButtons","ul","scrollLeft","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","draggable","closest","oldIndex","newIndex","removedSheetName","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","finish","animate","scrLeft","getcol","getrow","noThrow","stream","OUT","TokenStream","addReference","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","OPERATORS","ast","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsIf","makeContinuation","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","makeFormula","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","toCell","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","negative","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","RegExp","escaped","rx","getNumberRegexp","comma","dot","NUMBER_FORMAT_RX","repeat","FORMAT_PARSERS","registerFormatParser","ops","numberFormat","currency","rxnum","rxcur","suffix","has_currency","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","xl","progress","loading","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","integer","SEL_DEFINED_NAME","vbProcedure","defineName","Deferred","notify","recalcSheets","loadSheets","ready","promise","insertSheet","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","formulaRange","nCols","prevCellRef","relsFile","styleIndex","stop","acRef","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","SEL_HYPERLINK","leave","SEL_VALUE","SEL_STRING","SEL_FORMULA","setFormat","formatCode","setFill","setFont","fontFamily","setBorder","side","prop","BORDER_WIDTHS","shouldSet","applyName","xf","base","inlineStyles","xfId","namedStyles","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","fill","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","def","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot",0,11,12,14,15,16,17,18,19,21,22,45,47,48,49,"_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","sheetParamsFromJSON","or","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","ValidationFormulaContext","_names","unbind","_sheetChange","_sheetCommandRequest","_inputForRef","execute","commandOptions","editActiveCell","refresh","sheetByName","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","sheetByIndex","removeSheet","newSheet","_clearSheets","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","undefineName","nameValue","PDFMixin","_drawPDF","exportPDF","proxyTarget","fail","area","states","currentFormula","_formulaContextRefresh","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum",":alphanum","ctrl+:alphanum","alt+ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","*+pageup","*+pagedown","mouseup","*+cut","*+paste","*+copy","esc","alt+enter","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","closeHandler","editorClose","enableEditor","_lastCommandRequest","showError","openDialog","_activeTooltip","clientHeight","isEditorDisabled","onWheel","deltaX","originalEvent","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","rect","activeCellRectangle","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","_selectionMode","deactivate","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","detach","clipBoardValue","onPaste","hasHTML","hasPlainText","clipboardData","DOMStringList","types","onCopy","scrollRight","offset","coordinates","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","onEditorBarFocus","onEditorCellFocus","onEditorEsc","onEditorBlur","isFiltered","onEditorAction","onEditorShiftAction","deactivateEditor","viewEditor","isEditorDeactivateBound","one","focusLastActive","enableClipboard","executeRequest","executeCommand","executeDialog","additionalOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","asURL","drawCell","collection","hBorders","vBorders","showGrid","maybeLink","textDecoration","href","defaultBorder","shouldDrawCell","toHSV","backgroundColor","fontStyle","fontWeight","wordBreak","__dataType","paneClassNames","addCell","sibling","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","messages","errors","openUnsupported","shiftingNonblankCells","filterRangeContainingMerges","sortRangeContainingMerges","validationError","tabs","_height","_width","addColumn","addRow","Node","toDomTree","ContextMenu","contextMenuConfig","scrollbar","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","clientWidth","isClipboardDeactivated","_resize","tabstripHeight","outerHeight","formulaBarHeight","formulaBar","sheetsBarHeight","quickAccessAdjust","prependTo","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","handleWidth","_headerWidth","isRowResizer","_headerHeight","isFilterIcon","filterIconRect","isAutoFill","frozen","selecting","paneAt","containingPane","theGrid","refreshTools","totalHeight","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","dialog","dialogs","errorMessages","registered","sender","_filterMenuColumn","resizeDirection","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","vaxis","haxis","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","itemSelection","allHeaders","doLayout","forScreen","xCoords","yCoords","hb","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","_addDiv","selections","activeCellClasses","selectionClasses","activeFormulaColor","_activeFormulaColor","_directionClasses","_addTable","cssClass","autoFillRectangle","toDiv","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","PaneGrid","sum","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","_axis","_start","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","constructor","_values","_dates","_blanks","blanks","dates","_logic","logic","criteria","_criteria","expression","Query","filterExpr","filters","_matches","criterionValue","criterionType","valueType","TopFilter","DynamicFilter","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","names","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","sep","decimal","decimalPart","am","pm","readSection","sections","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","CACHE","TEXT","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","iv","chf","formatDec","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","COL","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","found","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","Hyperlink","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","withPreventDefault","BORDER_TYPES","BORDER_PALETTE_MESSAGES","ColorChooser","BorderPalette","borderPalette","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","colorPicker","formatTypes","automatic","percent","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortAsc","sortDesc","sortButtons","sortSheetAsc","sortSheetDesc","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","iconClass","dialogName","togglable","separator","formatCells","_expandTools","tools","toolbarName","handleClick","_addSeparators","click","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","splitButton","showText","toolIcon","tool","attributes","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","dataItem","popupName","ev","kendoPopup","registerComponent","ToolBarButton","_dialogName","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","setOptions","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_commandPalette","removeClass","_title","_reset","_quickAccessButtons","quickAccessToolBar","toolbars","contentElements","_toolbar","hasOwnProperty","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","MessageDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ModifyMergedDialog","OverflowDialog","UseKeyboardDialog","UnsupportedSelectionDialog","HyperlinkDialog","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","url","removeLink","register","dialogClass","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","messageId","getter","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","model","stopPropagation","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetInsertRow","_sheetDeleteRow","fields","getters","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getterIdx","distinctValues","query","itemVisible","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","and","doesnotcontain","startswith","endswith","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","notEqual","oldRect","newRect","barInput","cellInput","_triggerUpdate","lastActive","activeElement","_rect","inputType","linearRegression","findSeries","findStep","forEachSeries","formatType","getType","lst","findStringList","stringLists","strl","MSG_INCOMPATIBLE","MSG_NO_DIRECTION","MSG_READ_ONLY","srcRange","src","srcIdx","destRange","distributeCoords","heights","pageHeight","curr","getMergedCells","primary","secondary","pageWidth","scaleFactor","boxWidth","boxHeight","rowHeights","colWidths","maxRow","maxCol","nonEmpty","relrow","relcol","rh","cw","emptyCells","orlast","normalOrder","drawLayout","addPage","page","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","transform","moveTo","lineTo","stroke","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","vtrans","rect_left","rect_top","rect_width","rect_height","makeFontDef","lines","text_height","lineBreak","Text","htrans","eol","sub","paper","getPaperOptions","multiPage","geometry","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_workbookChange","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","pb","kendoProgressBar","chunkCount","always","_workbookPdfExport","plugin"],"mappings":"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AI1K,MAAMiO,OACV0E,EAAW3S,MAAMuB,KAAKoR,SACtBooC,EAAiB/6C,MAAMgW,YAAYgD,KAAK+hC,eASxCgX,GACA,YACA,MACA,KAEAG,GACA,OACA,OAEA9B,GACA,eACA,eAEAyC,GACA,YACA,MACA,IACA,KAEAZ,GACA,aACA,aAEAI,GACA,aACA,YACA,QAEAjB,GACA,YACA,OAEAgB,GACA,aACA,YACA,aAEAtC,GACA,SACA,SAEA8C,GACA,YACA,MACA,IACA,MAEAyB,GAAY,KACZD,GAAqB,MACrBzB,GACA,YACA,MACA,IACA,KAEA1C,GACA,YACA,gBAEAuC,GACA,aACA,aAEAC,GACA,aACA,aA6PAa,GACAuD,KAAQ,EACRC,KAAQ,EACRC,OAAU,EACVC,OAAU,EACVC,OAAU,EACVC,MAAS,EACTC,SAAU,EACVC,KAAQ,EACRC,aAAgB,EAChBC,QAAW,EACXC,cAAiB,EACjBC,WAAc,EACdC,iBAAoB,EACpBC,aAAgB,GAEhB1D,GACA2D,EAAG,UACHpxD,EAAG,IACHG,EAAG,OACHG,EAAG,QACHG,EAAG,WACHe,EAAG,KACHvB,GAAI,QACJoxD,GAAI,WACJC,GAAI,QACJlpC,GAAI,UACJmpC,GAAI,WACJC,GAAI,WACJC,GAAI,QACJC,GAAI,SACJC,GAAI,aACJC,GAAI,gBACJxxD,GAAI,OACJyxD,GAAI,UACJC,GAAI,cACJ50C,GAAI,iBACJmL,GAAI,sBACJlL,GAAI,sBACJzc,GAAI,2BACJqxD,GAAI,QACJvpC,GAAI,YACJwpC,GAAI,SACJC,GAAI,WACJC,GAAI,KAwIJvC,GACA,UACA,UAEAF,GACA,QACA,QAEAD,GACA,QACA,QAEAK,GACA,UACA,MAEAD,GACA,eACA,MAEAL,GACA,UACA,UAEAN,GACAF,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,EAAW,YACXA,E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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend;\n        var DEG_TO_RAD = math.PI / 180, MAX_NUM = Number.MAX_VALUE, MIN_NUM = -Number.MAX_VALUE, UNDEFINED = 'undefined';\n        function defined(value) {\n            return typeof value !== UNDEFINED;\n        }\n        function round(value, precision) {\n            var power = pow(precision);\n            return math.round(value * power) / power;\n        }\n        function pow(p) {\n            if (p) {\n                return math.pow(10, p);\n            } else {\n                return 1;\n            }\n        }\n        function limitValue(value, min, max) {\n            return math.max(math.min(value, max), min);\n        }\n        function rad(degrees) {\n            return degrees * DEG_TO_RAD;\n        }\n        function deg(radians) {\n            return radians / DEG_TO_RAD;\n        }\n        function isNumber(val) {\n            return typeof val === 'number' && !isNaN(val);\n        }\n        function valueOrDefault(value, defaultValue) {\n            return defined(value) ? value : defaultValue;\n        }\n        function sqr(value) {\n            return value * value;\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function hashObject(object) {\n            return hashKey(objectKey(object));\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function arrayLimits(arr) {\n            var length = arr.length, i, min = MAX_NUM, max = MIN_NUM;\n            for (i = 0; i < length; i++) {\n                max = math.max(max, arr[i]);\n                min = math.min(min, arr[i]);\n            }\n            return {\n                min: min,\n                max: max\n            };\n        }\n        function arrayMin(arr) {\n            return arrayLimits(arr).min;\n        }\n        function arrayMax(arr) {\n            return arrayLimits(arr).max;\n        }\n        function sparseArrayMin(arr) {\n            return sparseArrayLimits(arr).min;\n        }\n        function sparseArrayMax(arr) {\n            return sparseArrayLimits(arr).max;\n        }\n        function sparseArrayLimits(arr) {\n            var min = MAX_NUM, max = MIN_NUM;\n            for (var i = 0, length = arr.length; i < length; i++) {\n                var n = arr[i];\n                if (n !== null && isFinite(n)) {\n                    min = math.min(min, n);\n                    max = math.max(max, n);\n                }\n            }\n            return {\n                min: min === MAX_NUM ? undefined : min,\n                max: max === MIN_NUM ? undefined : max\n            };\n        }\n        function last(array) {\n            if (array) {\n                return array[array.length - 1];\n            }\n        }\n        function append(first, second) {\n            first.push.apply(first, second);\n            return first;\n        }\n        function renderTemplate(text) {\n            return kendo.template(text, {\n                useWithBlock: false,\n                paramName: 'd'\n            });\n        }\n        function renderAttr(name, value) {\n            return defined(value) && value !== null ? ' ' + name + '=\\'' + value + '\\' ' : '';\n        }\n        function renderAllAttr(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                output += renderAttr(attrs[i][0], attrs[i][1]);\n            }\n            return output;\n        }\n        function renderStyle(attrs) {\n            var output = '';\n            for (var i = 0; i < attrs.length; i++) {\n                var value = attrs[i][1];\n                if (defined(value)) {\n                    output += attrs[i][0] + ':' + value + ';';\n                }\n            }\n            if (output !== '') {\n                return output;\n            }\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function isTransparent(color) {\n            return color === '' || color === null || color === 'none' || color === 'transparent' || !defined(color);\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                if (id in cache) {\n                    return cache[id];\n                }\n                return f.apply(this, arguments);\n            };\n        }\n        function ucs2decode(string) {\n            var output = [], counter = 0, length = string.length, value, extra;\n            while (counter < length) {\n                value = string.charCodeAt(counter++);\n                if (value >= 55296 && value <= 56319 && counter < length) {\n                    extra = string.charCodeAt(counter++);\n                    if ((extra & 64512) == 56320) {\n                        output.push(((value & 1023) << 10) + (extra & 1023) + 65536);\n                    } else {\n                        output.push(value);\n                        counter--;\n                    }\n                } else {\n                    output.push(value);\n                }\n            }\n            return output;\n        }\n        function ucs2encode(array) {\n            return array.map(function (value) {\n                var output = '';\n                if (value > 65535) {\n                    value -= 65536;\n                    output += String.fromCharCode(value >>> 10 & 1023 | 55296);\n                    value = 56320 | value & 1023;\n                }\n                output += String.fromCharCode(value);\n                return output;\n            }).join('');\n        }\n        deepExtend(kendo, {\n            util: {\n                MAX_NUM: MAX_NUM,\n                MIN_NUM: MIN_NUM,\n                append: append,\n                arrayLimits: arrayLimits,\n                arrayMin: arrayMin,\n                arrayMax: arrayMax,\n                defined: defined,\n                deg: deg,\n                hashKey: hashKey,\n                hashObject: hashObject,\n                isNumber: isNumber,\n                isTransparent: isTransparent,\n                last: last,\n                limitValue: limitValue,\n                now: now,\n                objectKey: objectKey,\n                round: round,\n                rad: rad,\n                renderAttr: renderAttr,\n                renderAllAttr: renderAllAttr,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                renderStyle: renderStyle,\n                renderTemplate: renderTemplate,\n                sparseArrayLimits: sparseArrayLimits,\n                sparseArrayMin: sparseArrayMin,\n                sparseArrayMax: sparseArrayMax,\n                sqr: sqr,\n                valueOrDefault: valueOrDefault,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                ucs2encode: ucs2encode,\n                ucs2decode: ucs2decode\n            }\n        });\n        kendo.drawing.util = kendo.util;\n        kendo.dataviz.util = kendo.util;\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    (function ($) {\n        var doc = document, kendo = window.kendo, Class = kendo.Class, util = kendo.util, defined = util.defined;\n        var LRUCache = Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var lru = this, map = lru._map, entry = {\n                        key: key,\n                        value: value\n                    };\n                map[key] = entry;\n                if (!lru._head) {\n                    lru._head = lru._tail = entry;\n                } else {\n                    lru._tail.newer = entry;\n                    entry.older = lru._tail;\n                    lru._tail = entry;\n                }\n                if (lru._length >= lru._size) {\n                    map[lru._head.key] = null;\n                    lru._head = lru._head.newer;\n                    lru._head.older = null;\n                } else {\n                    lru._length++;\n                }\n            },\n            get: function (key) {\n                var lru = this, entry = lru._map[key];\n                if (entry) {\n                    if (entry === lru._head && entry !== lru._tail) {\n                        lru._head = entry.newer;\n                        lru._head.older = null;\n                    }\n                    if (entry !== lru._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = lru._tail;\n                        entry.newer = null;\n                        lru._tail.newer = entry;\n                        lru._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var defaultMeasureBox = $('<div style=\\'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: nowrap!important;\\' />')[0];\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var TextMetrics = Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this._initOptions(options);\n            },\n            options: { baselineMarkerSize: 1 },\n            measure: function (text, style, box) {\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = util.objectKey(style), cacheKey = util.hashKey(text + styleKey), cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = box ? box : defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (defined(value)) {\n                        measureBox.style[key] = value;\n                    }\n                }\n                $(measureBox).text(text);\n                measureBox.appendChild(baselineMarker);\n                doc.body.appendChild(measureBox);\n                if ((text + '').length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                return $('<div class=\\'k-baseline-marker\\' ' + 'style=\\'display: inline-block; vertical-align: baseline;' + 'width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;' + 'overflow: hidden;\\' />')[0];\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        function loadFonts(fonts, callback) {\n            var promises = [];\n            if (fonts.length > 0 && document.fonts) {\n                try {\n                    promises = fonts.map(function (font) {\n                        return document.fonts.load(font);\n                    });\n                } catch (e) {\n                    kendo.logToConsole(e);\n                }\n                Promise.all(promises).then(callback, callback);\n            } else {\n                callback();\n            }\n        }\n        kendo.util.TextMetrics = TextMetrics;\n        kendo.util.LRUCache = LRUCache;\n        kendo.util.loadFonts = loadFonts;\n        kendo.util.measureText = measureText;\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'apos': 39,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/base64', ['util/main'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend, fromCharCode = String.fromCharCode;\n        var KEY_STR = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        function encodeBase64(input) {\n            var output = '';\n            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;\n            var i = 0;\n            input = encodeUTF8(input);\n            while (i < input.length) {\n                chr1 = input.charCodeAt(i++);\n                chr2 = input.charCodeAt(i++);\n                chr3 = input.charCodeAt(i++);\n                enc1 = chr1 >> 2;\n                enc2 = (chr1 & 3) << 4 | chr2 >> 4;\n                enc3 = (chr2 & 15) << 2 | chr3 >> 6;\n                enc4 = chr3 & 63;\n                if (isNaN(chr2)) {\n                    enc3 = enc4 = 64;\n                } else if (isNaN(chr3)) {\n                    enc4 = 64;\n                }\n                output = output + KEY_STR.charAt(enc1) + KEY_STR.charAt(enc2) + KEY_STR.charAt(enc3) + KEY_STR.charAt(enc4);\n            }\n            return output;\n        }\n        function encodeUTF8(input) {\n            var output = '';\n            for (var i = 0; i < input.length; i++) {\n                var c = input.charCodeAt(i);\n                if (c < 128) {\n                    output += fromCharCode(c);\n                } else if (c < 2048) {\n                    output += fromCharCode(192 | c >>> 6);\n                    output += fromCharCode(128 | c & 63);\n                } else if (c < 65536) {\n                    output += fromCharCode(224 | c >>> 12);\n                    output += fromCharCode(128 | c >>> 6 & 63);\n                    output += fromCharCode(128 | c & 63);\n                }\n            }\n            return output;\n        }\n        deepExtend(kendo.util, {\n            encodeBase64: encodeBase64,\n            encodeUTF8: encodeUTF8\n        });\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('mixins/observers', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        var math = Math, kendo = window.kendo, deepExtend = kendo.deepExtend, inArray = $.inArray;\n        var ObserversMixin = {\n            observers: function () {\n                this._observers = this._observers || [];\n                return this._observers;\n            },\n            addObserver: function (element) {\n                if (!this._observers) {\n                    this._observers = [element];\n                } else {\n                    this._observers.push(element);\n                }\n                return this;\n            },\n            removeObserver: function (element) {\n                var observers = this.observers();\n                var index = inArray(element, observers);\n                if (index != -1) {\n                    observers.splice(index, 1);\n                }\n                return this;\n            },\n            trigger: function (methodName, event) {\n                var observers = this._observers;\n                var observer;\n                var idx;\n                if (observers && !this._suspended) {\n                    for (idx = 0; idx < observers.length; idx++) {\n                        observer = observers[idx];\n                        if (observer[methodName]) {\n                            observer[methodName](event);\n                        }\n                    }\n                }\n                return this;\n            },\n            optionsChange: function (e) {\n                e = e || {};\n                e.element = this;\n                this.trigger('optionsChange', e);\n            },\n            geometryChange: function () {\n                this.trigger('geometryChange', { element: this });\n            },\n            suspend: function () {\n                this._suspended = (this._suspended || 0) + 1;\n                return this;\n            },\n            resume: function () {\n                this._suspended = math.max((this._suspended || 0) - 1, 0);\n                return this;\n            },\n            _observerField: function (field, value) {\n                if (this[field]) {\n                    this[field].removeObserver(this);\n                }\n                this[field] = value;\n                value.addObserver(this);\n            }\n        };\n        deepExtend(kendo, { mixins: { ObserversMixin: ObserversMixin } });\n    }(window.kendo.jQuery));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n                return this._range;\n            },\n            _setRange: function (range) {\n                this._range = range;\n            },\n            redo: function () {\n                this.exec();\n            },\n            undo: function () {\n                this.setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function (state) {\n                this.range().setState(state);\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var TargetValueCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function () {\n                var range = this.range();\n                this._prevLink = range.link();\n                range.link(this._link);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                range.link(this._prevLink);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function (v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function (range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n                    range[this._property](this._value);\n                }\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                this.getState();\n                this.range().clearContent();\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            exec: function () {\n                var range = this.range();\n                var value = this._value;\n                this.getState();\n                try {\n                    range.link(null);\n                    range.input(value);\n                    var validationState = range._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex1) {\n                    if (ex1 instanceof kendo.spreadsheet.calc.ParseError) {\n                        try {\n                            range.input(value + ')');\n                            var validationState = range._getValidationState();\n                            if (validationState) {\n                                return this.rejectState(validationState);\n                            }\n                        } catch (ex2) {\n                            if (ex2 instanceof kendo.spreadsheet.calc.ParseError) {\n                                range.input('\\'' + value);\n                                return {\n                                    title: 'Error in formula',\n                                    body: ex1 + '',\n                                    reason: 'error'\n                                };\n                            }\n                        }\n                    } else {\n                        throw ex1;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._decimals = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var decimals = this._decimals;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (format || decimals > 0) {\n                            format = formatting.adjustDecimals(format || '#', decimals);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type](this._style);\n            },\n            noBorders: function () {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(null).borderTop(null).borderRight(null).borderBottom(null);\n                }.bind(this), {});\n            },\n            allBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderLeft(style).borderTop(style).borderRight(style).borderBottom(style);\n                }.bind(this), {});\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.leftColumn().borderLeft(style);\n                    range.topRow().borderTop(style);\n                    range.rightColumn().borderRight(style);\n                    range.bottomRow().borderBottom(style);\n                }.bind(this), {});\n            },\n            insideBorders: function (style) {\n                this.range().sheet().batch(function () {\n                    this.allBorders(style);\n                    this.outsideBorders(null);\n                }.bind(this), {});\n            },\n            insideHorizontalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderBottom(style);\n                    range.bottomRow().borderBottom(null);\n                }.bind(this), {});\n            },\n            insideVerticalBorders: function (style) {\n                var range = this.range();\n                range.sheet().batch(function () {\n                    range.borderRight(style);\n                    range.rightColumn().borderRight(null);\n                }.bind(this), {});\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = this._workbook.clipboard();\n            },\n            getState: function () {\n                this._range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                var status = this._clipboard.canPaste();\n                this._clipboard.menuInvoked = true;\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    }\n                    if (status.pasteOnMerged) {\n                        return {\n                            reason: 'error',\n                            type: 'modifyMerged'\n                        };\n                    }\n                    if (status.overflow) {\n                        return {\n                            reason: 'error',\n                            type: 'overflow'\n                        };\n                    }\n                    return { reason: 'error' };\n                }\n                this.getState();\n                this._clipboard.paste();\n                var range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                this._clipboard.menuInvoked = true;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    } else if (status.multiSelection) {\n                        return {\n                            reason: 'error',\n                            type: 'unsupportedSelection'\n                        };\n                    }\n                    return;\n                }\n                this._clipboard.copy();\n            }\n        });\n        function copyToClipboard(html) {\n            var textarea = document.createElement('textarea');\n            $(textarea).addClass('k-spreadsheet-clipboard').val(html).appendTo(document.body).focus().select();\n            document.execCommand('copy');\n            $(textarea).remove();\n        }\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('copy');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (this.range().enable() && this._clipboard.canCopy()) {\n                    this.getState();\n                    this._clipboard.cut();\n                }\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                this.getState();\n                try {\n                    this.range().fillFrom(this._origin);\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return {\n                            reason: 'error',\n                            body: ex + ''\n                        };\n                    }\n                    throw ex;\n                }\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('cut');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                if (range.hasFilter()) {\n                    range.filter(false);\n                } else if (!range.intersectingMerged().length) {\n                    range.filter(true);\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'filterRangeContainingMerges'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                if (!range.intersectingMerged().length) {\n                    range.sort({\n                        column: col,\n                        ascending: ascending\n                    });\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'sortRangeContainingMerges'\n                    };\n                }\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = kendo.spreadsheet.DeleteCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedRows();\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                sheet.axisManager().deleteSelectedColumns();\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getState();\n                if (this._value === 'left') {\n                    sheet.axisManager().addColumnLeft();\n                } else {\n                    sheet.axisManager().addColumnRight();\n                }\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                if (!sheet.axisManager().canAddRow()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                this._state = sheet.getState();\n                if (this._value === 'above') {\n                    sheet.axisManager().addRowAbove();\n                } else {\n                    sheet.axisManager().addRowBelow();\n                }\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                this.range().validation(this._value);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                this.options.workbook.fromFile(this.options.file);\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false).css('white-space', 'pre');\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'true';\n                }\n                this.enableEditing(enable);\n                this.element.toggleClass('k-state-disabled', !enable);\n            },\n            enableEditing: function (enable) {\n                if (enable) {\n                    this.element.attr('contenteditable', enable);\n                } else {\n                    this.element.removeAttr('contenteditable');\n                }\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger('blur');\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _move: function (key) {\n                var list = this.list;\n                var pressed = false;\n                var popup = this.popup;\n                if (key === keys.DOWN) {\n                    list.focusNext();\n                    if (!list.focus()) {\n                        list.focusFirst();\n                    }\n                    pressed = true;\n                } else if (key === keys.UP) {\n                    list.focusPrev();\n                    if (!list.focus()) {\n                        list.focusLast();\n                    }\n                    pressed = true;\n                } else if (key === keys.ENTER) {\n                    if (popup.visible()) {\n                        list.select(list.focus());\n                    }\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.TAB) {\n                    list.select(list.focus());\n                    popup.close();\n                    pressed = true;\n                } else if (key === keys.PAGEUP) {\n                    list.focusFirst();\n                    pressed = true;\n                } else if (key === keys.PAGEDOWN) {\n                    list.focusLast();\n                    pressed = true;\n                }\n                return pressed;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span style=\\'white-space: pre\\'/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.enableEditing(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.enableEditing(true);\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.show();\n                this.element.css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|op|punc)$/.test(left.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:punc|op)$/.test(left.type)) {\n                            return /^[,;({]$/.test(left.value) ? {\n                                token: left,\n                                end: point.end\n                            } : null;\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (ref) {\n                var x = this._canInsertRef();\n                if (x) {\n                    this._replaceAt(x, ref.simplify().toString());\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n                this._sync();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width, height;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.element[0].innerText;\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this._staticTokens.length || this._highlightedRefs.length) {\n                        this._staticTokens = [];\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                    return;\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            },\n            insertNewline: function () {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? '\\n\\n' : '\\n' + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (keyCode) {\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.keyCode));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey && !e.altKey;\n                if (e.altKey) {\n                    eventKey += 'alt+';\n                }\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function passThrough(value) {\n            return value;\n        }\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start - value.start > 0) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function Value(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(passThrough);\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state;\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats, validations) {\n                Property.prototype.init.call(this, values);\n                this.validations = validations;\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderBottom',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderRight',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderLeft',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'borderTop',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'link',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                }\n            ],\n            init: function (cellCount) {\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, spec.value);\n                }, this);\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name] = new spec.property(this.lists[spec.name], this.lists[spec.depends]);\n                }, this);\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                return this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                this.properties[name].set(start, end, value);\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                return this.properties[name].iterator(start, end);\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                var specs = this.specs.filter(function (spec) {\n                    return spec.serializable;\n                });\n                return specs.map(function (spec) {\n                    var iterator = this.iterator(spec.name, start, end);\n                    return {\n                        name: spec.name,\n                        value: spec.value,\n                        at: function (index) {\n                            return spec.property.fn.parse(iterator.at(index));\n                        }\n                    };\n                }, this);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                for (var index = start; index <= end; index++) {\n                    var values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        kendo.spreadsheet.ALL_PROPERTIES = $.map(kendo.spreadsheet.PropertyBag.prototype.specs, function (spec) {\n            return spec.name;\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        clone: function () {\n            return this;\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + '!' : '';\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col += acol;\n            }\n            if (ret.rel & 2) {\n                ret.row += arow;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref === NULL) {\n                return ref;\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            throw new Error('Unknown reference');\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1;\n                r1 = r2;\n                r2 = tmp;\n                tmp = rr1;\n                rr1 = rr2;\n                rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1;\n                c1 = c2;\n                c2 = tmp;\n                tmp = rc1;\n                rc1 = rc2;\n                rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n            return this;\n        },\n        print: function (trow, tcol) {\n            var abs = this.absolute(trow, tcol);\n            if (abs.valid()) {\n                var ret = this.topLeft.print(trow, tcol) + ':' + this.bottomRight.print(trow, tcol);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            return new RangeRef(new CellRef(this.topLeft.row + row, this.topLeft.col), new CellRef(this.topLeft.row + row, this.bottomRight.col));\n        },\n        toColumn: function (col) {\n            return new RangeRef(new CellRef(this.topLeft.row, this.topLeft.col + col), new CellRef(this.bottomRight.row, this.topLeft.col + col));\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft;\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function () {\n            return new UnionRef(this.refs.slice());\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(callback, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            return new UnionRef(this.refs.map(callback, obj));\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting, shiftKey) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == 'range') {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selection = sheet.currentNavigationRange();\n                var selTopLeft = selection.topLeft;\n                var selBottomRight = selection.bottomRight;\n                var done = false;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol, true);\n                            if (column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                row = rows.nextVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol, true);\n                            if (column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                row = rows.prevVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow, true);\n                            if (row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                column = columns.nextVisible(column, true);\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow, true);\n                            if (row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                column = columns.prevVisible(column, true);\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction, row;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        var props = preview.props;\n                        if (direction === 0 || direction == 1) {\n                            row = props[props.length - 1];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 2) {\n                            row = props[0];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 3) {\n                            row = props[props.length - 1];\n                            hint = row[0].value;\n                        }\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.deleteColumn(index - i);\n                });\n            },\n            deleteSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.deleteRow(index - i);\n                });\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(0, sel), new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel));\n                    sheet.range(ref).select();\n                }\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(sel, 0), new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1));\n                    sheet.range(ref).select();\n                }\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            addColumnLeft: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index - i);\n                });\n            },\n            addColumnRight: function () {\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    sheet.insertColumn(index + (i + 1));\n                });\n            },\n            canAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.canInsertRow(0, rowCount);\n            },\n            addRowAbove: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index - i);\n                });\n            },\n            addRowBelow: function () {\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    sheet.insertRow(index + (i + 1));\n                });\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = true;\n                this._external = {};\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var status = { canPaste: true };\n                if (ref === kendo.spreadsheet.NULLREF) {\n                    var external = this.isExternal();\n                    status.pasteOnMerged = this.intersectsMerged();\n                    status.canPaste = status.pasteOnMerged ? false : external;\n                    return status;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                var state = this.parse(this._external);\n                this.origin = getSourceRef(state);\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this.contents = sheet.selection().getState();\n                delete this._external.html;\n                delete this._external.plain;\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            paste: function () {\n                var state = {};\n                var sheet = this.workbook.activeSheet();\n                if (this._isInternal()) {\n                    state = this.contents;\n                } else {\n                    state = this.parse(this._external);\n                    this.origin = getSourceRef(state);\n                }\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).setState(state, this);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data && (data.html || data.plain)) {\n                    this._external = data;\n                } else {\n                    return this._external;\n                }\n            },\n            isExternal: function () {\n                return !this._isInternal();\n            },\n            parse: function (data) {\n                var state = newState();\n                if (data.html) {\n                    var doc = this.iframe.contentWindow.document;\n                    doc.open();\n                    doc.write(data.html);\n                    doc.close();\n                    var table = $(doc).find('table:first');\n                    if (table.length) {\n                        state = parseHTML(table.find('tbody:first'));\n                    } else if (!data.plain) {\n                        var element = $(doc.body).find(':not(style)');\n                        setStateData(state, 0, 0, cellState(element.text()));\n                    } else {\n                        state = parseTSV(data.plain);\n                    }\n                } else {\n                    state = parseTSV(data.plain);\n                }\n                return state;\n            },\n            _isInternal: function () {\n                if (this._external.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._external.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._external.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                if (internalHTML || internalPlain) {\n                    return true;\n                }\n                return false;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref: ref,\n                mergedCells: [],\n                data: [],\n                foreign: true,\n                origRef: ref.toRangeRef()\n            };\n        }\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n        function getSourceRef(state) {\n            return state.origRef;\n        }\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, '');\n        }\n        function borderObject(styles) {\n            var obj = {};\n            [\n                'borderBottom',\n                'borderRight',\n                'borderLeft',\n                'borderTop'\n            ].forEach(function (key) {\n                obj[key] = styles[key + 'Style'] == 'none' ? null : {\n                    size: 1,\n                    color: styles[key + 'Color']\n                };\n            });\n            return obj;\n        }\n        function cellState(element) {\n            var styles = window.getComputedStyle(element[0]);\n            var text = element.text();\n            var borders = borderObject(styles);\n            var state = {\n                value: text === '' ? null : text,\n                borderBottom: borders.borderBottom,\n                borderRight: borders.borderRight,\n                borderLeft: borders.borderLeft,\n                borderTop: borders.borderTop,\n                fontSize: parseInt(styles['font-size'], 10)\n            };\n            if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                state.background = styles['background-color'];\n            }\n            if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                state.color = styles.color;\n            }\n            if (styles['text-decoration'] == 'underline') {\n                state.underline = true;\n            }\n            if (styles['font-style'] == 'italic') {\n                state.italic = true;\n            }\n            if (styles['font-weight'] == 'bold') {\n                state.bold = true;\n            }\n            if (stripStyle(styles['text-align']) !== 'right') {\n                state.textAlign = stripStyle(styles['text-align']);\n            }\n            if (styles['vertical-align'] !== 'middle') {\n                state.verticalAlign = styles['vertical-align'];\n            }\n            if (styles['word-wrap'] !== 'normal') {\n                state.wrap = true;\n            }\n            return state;\n        }\n        function parseHTML(tbody) {\n            var state = newState();\n            tbody.find('tr').each(function (rowIndex, tr) {\n                $(tr).find('td').each(function (colIndex, td) {\n                    var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                    var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                    var blankCell = '<td/>';\n                    var ci;\n                    if (rowspan) {\n                        var endRow = rowIndex + rowspan;\n                        for (var ri = rowIndex; ri <= endRow; ri++) {\n                            var row = tbody.find('tr').eq(ri);\n                            if (ri > rowIndex) {\n                                blankCell = '<td class=\\'rowspan\\'></td>';\n                                if (colIndex === 0) {\n                                    row.find('td').eq(colIndex).after(blankCell);\n                                } else {\n                                    var last = Math.min(row.find('td').length, colIndex);\n                                    row.find('td').eq(last - 1).after(blankCell);\n                                }\n                            }\n                            if (colspan) {\n                                for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                    blankCell = '<td class=\\'rowspan colspan\\'></td>';\n                                    row.find('td').eq(ci).after(blankCell);\n                                }\n                            }\n                        }\n                    } else {\n                        if (colspan) {\n                            for (ci = colIndex; ci < colspan + colIndex; ci++) {\n                                blankCell = '<td class=\\'colspan\\'></td>';\n                                $(tr).find('td').eq(ci).after(blankCell);\n                            }\n                        }\n                    }\n                });\n            });\n            tbody.find('tr').each(function (rowIndex, tr) {\n                $(tr).find('td').each(function (colIndex, td) {\n                    var rowspan = parseInt($(td).attr('rowspan'), 10) - 1 || 0;\n                    var colspan = parseInt($(td).attr('colspan'), 10) - 1 || 0;\n                    setStateData(state, rowIndex, colIndex, cellState($(td)));\n                    if (rowspan || colspan) {\n                        var startCol = String.fromCharCode(65 + colIndex);\n                        var endCol = String.fromCharCode(65 + colIndex + colspan);\n                        var address = startCol + (rowIndex + 1) + ':' + endCol + (rowIndex + 1 + rowspan);\n                        state.mergedCells.push(address);\n                    }\n                });\n            });\n            return state;\n        }\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split('\\n');\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split('\\t');\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var PROPERTIES = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'verticalAlign',\n            'background',\n            'format',\n            'link'\n        ];\n        var borders = {\n            borderTop: {\n                complement: 'borderBottom',\n                direction: {\n                    top: -1,\n                    bottom: -1\n                }\n            },\n            borderLeft: {\n                complement: 'borderRight',\n                direction: {\n                    left: -1,\n                    right: -1\n                }\n            },\n            borderRight: {\n                complement: 'borderLeft',\n                direction: {\n                    left: 1,\n                    right: 1\n                }\n            },\n            borderBottom: {\n                complement: 'borderTop',\n                direction: {\n                    top: 1,\n                    bottom: 1\n                }\n            }\n        };\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            clone: function () {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n            skipHiddenCells: function () {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function add(ref) {\n                    if (ref instanceof UnionRef) {\n                        ref.forEach(add);\n                    } else {\n                        ref = self._normalize(ref.toRangeRef());\n                        var tl = ref.topLeft, br = ref.bottomRight;\n                        var rows = partition(tl.row, br.row, skipHiddenRows);\n                        var cols = partition(tl.col, br.col, skipHiddenCols);\n                        for (var i = 0; i < rows.length; ++i) {\n                            for (var j = 0; j < cols.length; ++j) {\n                                refs.push(new RangeRef(new CellRef(rows[i].begin, cols[j].begin), new CellRef(rows[i].end, cols[j].end)));\n                            }\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        ref: self._ref\n                    });\n                }\n                return self;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            _border: function (property, value) {\n                var result;\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    result = this._property(property, value);\n                    if (value !== undefined) {\n                        this._resizedRef(direction).forEach(function (ref) {\n                            if (ref !== kendo.spreadsheet.NULLREF) {\n                                new Range(ref, sheet)._property(complement, null);\n                            }\n                        });\n                    }\n                }.bind(this), {});\n                return result;\n            },\n            _collapsedBorder: function (property) {\n                var result = this._property(property);\n                var complement = borders[property].complement;\n                var direction = borders[property].direction;\n                this._resizedRef(direction).forEach(function (ref) {\n                    if (!result && ref !== kendo.spreadsheet.NULLREF) {\n                        var range = new Range(ref, this._sheet);\n                        result = range._property(complement);\n                    }\n                }.bind(this));\n                return result;\n            },\n            borderTop: function (value) {\n                return this._border('borderTop', value);\n            },\n            borderRight: function (value) {\n                return this._border('borderRight', value);\n            },\n            borderBottom: function (value) {\n                return this._border('borderBottom', value);\n            },\n            borderLeft: function (value) {\n                return this._border('borderLeft', value);\n            },\n            collapsedBorderTop: function () {\n                return this._collapsedBorder('borderTop');\n            },\n            collapsedBorderRight: function () {\n                return this._collapsedBorder('borderRight');\n            },\n            collapsedBorderBottom: function () {\n                return this._collapsedBorder('borderBottom');\n            },\n            collapsedBorderLeft: function () {\n                return this._collapsedBorder('borderLeft');\n            },\n            input: function (value) {\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != '@') {\n                            if (x.type == 'date') {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == 'percent') {\n                                this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                            } else if (x.format && !existingFormat) {\n                                this.format(x.format);\n                            }\n                        } else if (x.type != 'string') {\n                            x.value = value;\n                        }\n                        this.formula(formula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && type == 'date') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1);\n                                if (typeof x.value == 'number') {\n                                    var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                    if (t1 == t2) {\n                                        value = t1;\n                                        break OUT;\n                                    }\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = value * 100 + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    value = true;\n                    this._sheet.forEach(this._ref.toRangeRef(), function (_, __, data) {\n                        if (data.enable === false) {\n                            value = false;\n                        }\n                    });\n                    return value;\n                }\n                this._property('enable', value);\n            },\n            formula: function (value) {\n                if (value === undefined) {\n                    var f = this._get('formula');\n                    return f ? '' + f : null;\n                }\n                return this._property('formula', value);\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    this._sheet._set(ref, 'formula', null);\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        if (propName == 'value') {\n                            sheet._set(ref, 'formula', null);\n                        }\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                var clearAll = !options || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options && options.contentsOnly === true,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options && options.formatOnly === true) {\n                        PROPERTIES.forEach(function (x) {\n                            this[x](null);\n                        }.bind(this));\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !(this._ref instanceof UnionRef || this._ref === kendo.spreadsheet.NULLREF);\n            },\n            sort: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    throw new Error('Unsupported for NULLREF.');\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(i);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref: topLeft,\n                    data: [],\n                    origRef: this._ref\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                var data = state.data;\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n                    properties.forEach(function (property) {\n                        cellState[property] = typeof cell[property] == 'undefined' ? null : cell[property];\n                    });\n                });\n                return state;\n            },\n            setState: function (state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    var row = origin.row;\n                    state.data.forEach(function (data, dr) {\n                        if (clipboard && !clipboard.isExternal() && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function (cellState, dc) {\n                            if (clipboard && !clipboard.isExternal() && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col) : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != 'value') {\n                                        range._set(property, cellState[property]);\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    if (clipboard && clipboard.isExternal()) {\n                                        try {\n                                            range.input(cellState.value);\n                                        } catch (ex) {\n                                            range._set('value', cellState.value);\n                                        }\n                                    } else {\n                                        range._set('value', cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true });\n            },\n            _adjustRowHeight: function () {\n                var sheet = this._sheet;\n                var state = this.getState();\n                var mergedCells = [];\n                for (var i = 0; i < state.mergedCells.length; i++) {\n                    mergedCells.push(sheet.range(state.mergedCells[i]));\n                }\n                this.forEachRow(function (row) {\n                    if (row.topLeft().row >= row.sheet()._rows._count) {\n                        return;\n                    }\n                    var maxHeight = row.sheet().rowHeight(row.topLeft().row);\n                    row.forEachCell(function (rowIndex, colIndex, cell) {\n                        var cellRange = sheet.range(rowIndex, colIndex);\n                        var totalWidth = 0;\n                        for (var i = 0; i < mergedCells.length; i++) {\n                            if (cellRange._ref.intersects(mergedCells[i]._ref)) {\n                                totalWidth += cell.width;\n                                break;\n                            }\n                        }\n                        var width = Math.max(sheet.columnWidth(colIndex), totalWidth);\n                        maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, cell.wrap));\n                    });\n                    sheet.rowHeight(row.topLeft().row, Math.max(sheet.rowHeight(row.topLeft().row), maxHeight));\n                });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var result = false;\n                this.forEachCell(function (row, col, cell) {\n                    if (Object.keys(cell).length !== 0) {\n                        result = true;\n                    }\n                });\n                return result;\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, true));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('wrap', flag);\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, size, cell.wrap));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('fontSize', size);\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            }\n        });\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [{\n                            begin: begin,\n                            end: i - 1\n                        }].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{\n                    begin: begin,\n                    end: end\n                }];\n        }\n        $.each(PROPERTIES, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px !important; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap !important; word-break: break-all !important;\" />')[0];\n        function getTextHeight(text, width, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': width + 'px',\n                'font-size': (fontSize || 12) + 'px',\n                'word-break': wrap === true ? 'break-all' : 'normal',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre'\n            };\n            return kendo.util.measureText(text, styles, measureBox).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    val = self.getRefData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        error: function (val) {\n            return new CalcError(val);\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            }\n            var f = this.formula;\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(cell) {\n                cell.formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, f) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data));\n                } else {\n                    ret.push(val);\n                }\n            }\n            if (f) {\n                return f.apply(this, ret);\n            }\n            return ret;\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo) {\n            return this.ss.getRefCells(refs, hiddenInfo);\n        },\n        getRefData: function (ref) {\n            return this.ss.getData(ref);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n        },\n        clone: function (sheet, row, col) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            if (lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && ref.sheet.toLowerCase() != lcsheet) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                if (!this.absrefs) {\n                    this.absrefs = this.refs.map(function (ref) {\n                        return ref.absolute(this.row, this.col);\n                    }, this);\n                }\n                this.handler.call(ctx);\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                if (ref.sheet.toLowerCase() == oldSheetName) {\n                    ref.sheet = newSheetName;\n                }\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            this.refs = this.refs.map(function (ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }, this);\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', main + ' return { check: check };');\n        }\n        f = f(CalcError);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')).filter(function($' + name + '){ ';\n                    if (type[0] == 'collect') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'return ' + cond(type[1]) + '; }, this); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function forceNum() {\n            return '(' + '(typeof ' + force() + ' == \\'number\\') || ' + '(typeof $' + name + ' == \\'boolean\\') || ' + '(typeof $' + name + ' == \\'string\\' && !/^(?:=|true|false)/i.test($' + name + ') ? (' + 'tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $' + name + '), ' + '/^date|number|percent$/.test(tmp.type) ? ($' + name + ' = +tmp.value, true) : false' + ') : false)' + ')';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this.asMatrix(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number' || type == 'datetime') {\n                return forceNum();\n            }\n            if (type == 'integer' || type == 'date') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0), true))';\n            }\n            if (type == 'divisor') {\n                return '(' + forceNum() + ' && ($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '(' + forceNum() + ' && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '(' + forceNum() + ' && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : false)';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str) {\n        return kendo.parseDate(str) || kendo.parseDate(str, [\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM'\n        ]);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        return m;\n    }).args([[\n            'm',\n            'matrix'\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list') {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to.value ? this.to.value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from.value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from.value : '';\n            var to = this.to ? this.to.value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from.value || !this.from.value.data) {\n                return [];\n            }\n            var cube = this.from.value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            var calculateFromCallBack = function () {\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function () {\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            if (this.from) {\n                this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function () {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth) {\n                var cellCount = rowCount * columnCount - 1;\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(cellCount);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            formula.adjust(affectedSheet, operation, start, delta);\n                        });\n                        sheet._forValidations(function (validation) {\n                            validation.adjust(affectedSheet, operation, start, delta);\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                var axis = operation == 'col' ? this._columns : this._rows;\n                axis.adjust(start, delta);\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            canInsertRow: function (rowIndex, count) {\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                return !range.hasValue();\n            },\n            insertRow: function (rowIndex) {\n                if (!this.canInsertRow(rowIndex)) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear();\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear();\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            showGridLines: function (value) {\n                return this._field('_showGridLines', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = this._ref(ref);\n                }\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var ri = topLeft.row;\n                    var startCellIndex = this._grid.index(ri, ci);\n                    var endCellIndex = this._grid.index(bottomRight.row, ci);\n                    this._properties.forEach(startCellIndex, endCellIndex, function (value) {\n                        callback(ri++, ci, value);\n                    });\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger('commandRequest', {\n                                command: 'ColumnWidthCommand',\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger('commandRequest', {\n                                command: 'RowHeightCommand',\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this.trigger('commandRequest', {\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger('commandRequest', {\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var rowSelection = bottomRight.col === Infinity;\n                    var colSelection = bottomRight.row === Infinity;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = ref.topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = ref.topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref: kendo.spreadsheet.Ref.display(null, row, col),\n                            target: cell.link\n                        });\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        cell.formula = cell.formula.toString();\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        cell.formula = this._compileFormula(rowIndex, columnIndex, cell.formula);\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef;\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n                });\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation.from != null) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to != null) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason);\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-font-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-button-bare',\n            sheetsBarKArrowW: 'k-i-arrow-w',\n            sheetsBarKArrowE: 'k-i-arrow-e',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-x',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function (canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                var scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                var scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                var gapWidth = 2;\n                var addButton = that.element.find(DOT + classNames.sheetsBarAdd);\n                var addButtonWidth = addButton.outerWidth() + addButton.position().left + gapWidth;\n                var scrollPrevButtonWidth = scrollPrevButton.outerWidth() + gapWidth;\n                var sheetsGroup = that._sheetsGroup();\n                scrollPrevButton.css({ left: addButtonWidth });\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                sheetsGroup.css({ marginLeft: addButtonWidth });\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth;\n                if (sheetsGroupScrollWidth + addButtonWidth > wrapperOffsetWidth) {\n                    var scrollNextButtonRight = Math.ceil(kendo.parseFloat(scrollNextButton.css('right')));\n                    if (!that._scrollableModeActive) {\n                        that._nowScrollingSheets = false;\n                        that._scrollableModeActive = true;\n                    }\n                    sheetsGroup.css({\n                        marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                        marginRight: scrollNextButton.outerWidth() + scrollNextButtonRight + gapWidth\n                    });\n                } else {\n                    if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                        that._scrollableModeActive = false;\n                        sheetsGroup.css({\n                            marginLeft: addButtonWidth,\n                            marginRight: ''\n                        });\n                    } else {\n                        sheetsGroup.css({ marginLeft: addButtonWidth });\n                    }\n                }\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.toggle(false);\n                    next.toggle(false);\n                } else {\n                    prev.toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                    next.toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                        elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n            _onEditorBlur: function () {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this.trigger('remove', { name: removedSheetName });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKSprite + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = item.outerWidth();\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS = Object.create(null);\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS[op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', ',')) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom(commas)), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            if (!is('punc', ')')) {\n                while (1) {\n                    if (is('op', ',')) {\n                        args.push({ type: 'null' });\n                        input.next();\n                        continue;\n                    }\n                    args.push(parseExpression(false));\n                    if (input.eof() || is('punc', ')')) {\n                        break;\n                    }\n                    skip('op', ',');\n                }\n            }\n            skip('punc', ')');\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom(commas) {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')');\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}');\n            } else if (is('num') || is('str') || is('error')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseExpression(commas)\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is('punc', ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip('op', ',');\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != ',')) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(commas), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function makePrinter(exp) {\n        return makeClosure('function(row, col){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'error':\n                return JSON.stringify('#' + node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + \\', \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + \\', \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'error':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula;\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'error') {\n                return 'context.error(' + JSON.stringify(node.value) + ')';\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function isWhitespace(ch) {\n        return ' \\t\\n\\xA0\\u200B'.indexOf(ch) >= 0;\n    }\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || ch.toLowerCase() != ch.toUpperCase();\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == '.') {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            return {\n                type: 'num',\n                value: parseFloat(number)\n            };\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !c || a && c) {\n                var negative = a && /-$/.test(a);\n                var num = parseInt(b, 10);\n                if (negative) {\n                    num = -num;\n                }\n                if (!a) {\n                    num--;\n                }\n                return num;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[-?)?([0-9]+)(\\])?C(\\[-?)?([0-9]+)(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] ? 1 : 0) | (m[1] ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch)) {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character: ' + ch);\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    var EOF = { type: 'eof' };\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg + ' (input: ' + input + ')', pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^[0-9.]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            return {\n                type: 'number',\n                value: num\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm',\n                value: runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: 'mm:ss.00',\n                value: runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm:ss',\n                value: runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: 'hh:mm:ss.00',\n                value: runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp('^\\\\s*\\\\' + currency + '\\\\s*');\n        var sign = 1;\n        var format = '';\n        var suffix = '';\n        var has_currency = false;\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, ''));\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n        if (m = input.skip(rxcur)) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;\n            }\n            sign = -1;\n        }\n        if (!(n = input.skip(rxnum))) {\n            return null;\n        }\n        format += '#';\n        if (m = input.skip(rxcur)) {\n            if (has_currency) {\n                return null;\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n        if (!input.eof()) {\n            return null;\n        }\n        if (n[2] || has_currency) {\n            format += ',#';\n        }\n        if (n[3]) {\n            format += '.' + repeat('0', n[3].length - 1);\n        }\n        var value = n[0].replace(new RegExp('\\\\' + comma, 'g'), '').replace(new RegExp('\\\\' + dot, 'g'), '.');\n        return {\n            type: 'number',\n            format: format + suffix,\n            value: sign * parseFloat(value)\n        };\n    });\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = '^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)';\n            rx = rx.replace(/DOT/g, '\\\\' + dot).replace(/COM/g, '\\\\' + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    var SEL_HYPERLINK = [\n        'hyperlinks',\n        'hyperlink'\n    ];\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            file = 'xl/' + file;\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n    function readWorkbook(zip, workbook, progress) {\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, '_rels/workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var ref = parseReference(text, true);\n                    workbook.defineName(attrs.name, ref, bool(attrs.hidden));\n                }\n            }\n        });\n        var loading = new $.Deferred();\n        loading.progress(function (args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        }).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n            if (progress) {\n                progress.resolve();\n            }\n        });\n        loadSheets(items, workbook, loading);\n    }\n    function loadSheets(items, workbook, progress) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n                    promise.then(function () {\n                        progress.notify(args);\n                    });\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        ready.then(function () {\n            progress.resolve();\n        });\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return Math.floor(fraction) * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * 1.5625;\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var ref, type, value, formula, formulaRange;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, 'worksheets/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    formulaRange = null;\n                    ref = attrs.r;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    if (attrs.width) {\n                        var width = toColWidth(parseFloat(attrs.width));\n                        sheet._columns.values.value(start, stop, width);\n                    }\n                    if (attrs.hidden === '1') {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    if (attrs.ht) {\n                        var height = toRowHeight(parseFloat(attrs.ht));\n                        sheet._rows.values.value(row, row, height);\n                    }\n                    if (attrs.hidden === '1') {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                } else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs['r:id'];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        try {\n                            sheet.range(formulaRange || ref).formula(formula);\n                        } catch (ex) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    if (attrs.t == 'shared') {\n                        formulaRange = attrs.ref;\n                    }\n                }\n            }\n        });\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            range._property('fontSize', f.size);\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        parse(zip, 'xl/sharedStrings.xml', {\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = '';\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, xl(file) + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag) && attrs.style) {\n                        border[tag] = { style: attrs.style };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    return INDEXED_COLORS[0];\n                }\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = xl(rel);\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'change',\n                'excelImport',\n                'excelExport'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _sheetCommandRequest: function (e) {\n                this.trigger('commandRequest', e);\n            },\n            _inputForRef: function (ref) {\n                return new kendo.spreadsheet.Range(ref, this._sheet).input();\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else if (commandOptions.editActiveCell) {\n                    command.range(sheet.activeCellSelection());\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    this.undoRedoStack.push(command);\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheet.bind('commandRequest', this._sheetCommandRequest.bind(this));\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name();\n                if (!newSheetName || oldSheetName === newSheetName) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            _clearSheets: function () {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._clearSheets();\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows: args.rowCount,\n                            columns: args.columnCount,\n                            rowHeight: args.rowHeight,\n                            columnWidth: args.columnWidth,\n                            headerHeight: args.headerHeight,\n                            headerWidth: args.headerWidth,\n                            data: data\n                        });\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        return sheet.toJSON();\n                    }, this)\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            defineName: function (name, value, hidden) {\n                this._names[name] = {\n                    value: value,\n                    hidden: hidden\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name];\n            },\n            nameValue: function (name) {\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var ref = this.nameValue(name);\n                    if (ref instanceof kendo.spreadsheet.Ref && ref.sheet.toLowerCase() == affectedSheet) {\n                        ref = ref.adjust(null, null, null, null, forRow, start, delta);\n                        this.defineName(name, ref);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n            var rowCount = or(data.rowCount, options.rows, 200), columnCount = or(data.columnCount, options.columns, 50), rowHeight = or(data.rowHeight, options.rowHeight, 20), columnWidth = or(data.columnWidth, options.columnWidth, 64), headerHeight = or(data.headerHeight, options.headerHeight, 20), headerWidth = or(data.headerWidth, options.headerWidth, 32);\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) {\n                        rowCount = ri + 1;\n                    }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) {\n                                columnCount = ci + 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                rowCount: rowCount,\n                columnCount: columnCount,\n                rowHeight: rowHeight,\n                columnWidth: columnWidth,\n                headerHeight: headerHeight,\n                headerWidth: headerWidth\n            };\n        }\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.workbook.nameValue(ref.name);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo);\n                }\n                return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('NAME') }];\n            }\n            return [];\n        },\n        getData: function (ref) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref).map(function (cell) {\n                return cell.value;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                value.each(function (value, r, c) {\n                    sheet._value(row + r, col + c, value);\n                });\n            } else {\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            'alt+ctrl+:alphanum': 'edit',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            '*+pageup': 'onPageUp',\n            '*+pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'alt+enter': 'insertNewline',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this._enableEditorEvents();\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    var closeHandler;\n                    if (this.view.editor.isActive()) {\n                        this.enableEditor(false);\n                        closeHandler = this.enableEditor.bind(this, true, true);\n                    }\n                    if (result.reason === 'error') {\n                        this._lastCommandRequest = null;\n                        this.view.showError(result, closeHandler);\n                    } else {\n                        this.view.openDialog(result.reason, { close: closeHandler });\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind('commandRequest', this.onCommandRequest.bind(this));\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    editor.value(workbook._inputForRef(sheet.activeCell()));\n                }\n            },\n            onScroll: function () {\n                this.view.render();\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    if (action == 'delete' || action == 'backspace') {\n                        if (!disabled) {\n                            this._execute({ command: 'ClearContentCommand' });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || action === ':edit') {\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (action !== ':edit') {\n                            this.editor.value('');\n                        }\n                        this.editor.activate({\n                            range: this._workbook.activeSheet()._viewActiveCell(),\n                            rect: this.view.activeCellRectangle(),\n                            tooltip: this._activeTooltip()\n                        }).focus();\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this.editor.deactivate();\n                    if (this.editor.isActive()) {\n                        event.preventDefault();\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    pageX: event.pageX,\n                    pageY: event.pageY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            var html = this.clipboardElement.html();\n                            var plain = window.clipboardData.getData('Text').trim();\n                            if (!html && !plain) {\n                                return;\n                            }\n                            this.clipboard.external({\n                                html: html,\n                                plain: plain\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: { workbook: this.view._workbook }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: { workbook: this.view._workbook }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                var offset = this.container.offset();\n                var coordinates = {\n                    left: location.pageX - offset.left,\n                    top: location.pageY - offset.top\n                };\n                return this.view.objectAt(coordinates.left, coordinates.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            onEditorChange: function (e) {\n                this._workbook.activeSheet().isInEditMode(false);\n                var result = this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        editActiveCell: true,\n                        value: e.value\n                    }\n                });\n                if (result && result.reason === 'error') {\n                    e.preventDefault();\n                }\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet()._viewActiveCell(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            insertNewline: function (e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this.editor.deactivate();\n                if (!this.editor.isActive()) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet.selection()._ref);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            deactivateEditor: function (callback, options) {\n                var viewEditor = this.view.editor;\n                this._lastCommandRequest = {\n                    callback: callback,\n                    options: options\n                };\n                if (!this.isEditorDeactivateBound) {\n                    this.isEditorDeactivateBound = true;\n                    viewEditor.one('deactivate', function () {\n                        this.isEditorDeactivateBound = false;\n                        if (this._lastCommandRequest) {\n                            this._lastCommandRequest.callback(this._lastCommandRequest.options);\n                            this._lastCommandRequest = null;\n                        }\n                    }.bind(this));\n                }\n                viewEditor.deactivate();\n                this.enableEditor(false);\n            },\n            enableEditor: function (enable, focusLastActive) {\n                enable = enable === undefined || enable;\n                this._enableEditorEvents(enable);\n                this.editor.enableEditing(enable);\n                this.isEditorDisabled = !enable;\n                this.view.enableClipboard(enable);\n                if (focusLastActive) {\n                    this.editor.focusLastActive();\n                }\n            },\n            executeRequest: function (callback, options) {\n                if (this.view.editor.isActive()) {\n                    this.deactivateEditor(callback, options);\n                } else {\n                    callback(options);\n                }\n            },\n            onCommandRequest: function (e) {\n                var executeCommand = function (e) {\n                    if (e.command) {\n                        this._execute(e);\n                    } else {\n                        this._workbook.undoRedoStack[e.action]();\n                    }\n                }.bind(this);\n                this.executeRequest(executeCommand, e);\n            },\n            onDialogRequest: function (e) {\n                var executeDialog = function (e) {\n                    this.enableEditor(false);\n                    var additionalOptions = {\n                        pdfExport: this._workbook.options.pdf,\n                        excelExport: this._workbook.options.excel,\n                        close: this.enableEditor.bind(this, true, false)\n                    };\n                    if (e.options) {\n                        $.extend(true, e.options, additionalOptions);\n                    } else {\n                        e.options = additionalOptions;\n                    }\n                    this.view.openDialog(e.name, e.options);\n                }.bind(this);\n                this.executeRequest(executeDialog, e);\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            editContainer: 'k-spreadsheet-edit-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            horizontalResize: 'k-horizontal-resize',\n            verticalResize: 'k-vertical-resize',\n            icon: 'k-icon k-font-icon',\n            iconFilterDefault: 'k-i-arrow-s',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        kendo.spreadsheet.messages.view = {\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                validationError: 'The value that you entered violates the validation rules set on the cell.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return [\n                'solid',\n                (value.size || 1) + 'px',\n                value.color || '#000'\n            ].join(' ');\n        }\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = 'http://' + link;\n            }\n            return link;\n        }\n        function drawCell(collection, cell, cls, hBorders, vBorders, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == 'object') {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = { textDecoration: 'none' };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = 'underline';\n                    }\n                    return kendo.dom.element('a', {\n                        href: asURL(link),\n                        style: style,\n                        target: '_blank'\n                    }, el ? [el] : []);\n                }\n                return el;\n            }\n            if (!cls && !kendo.spreadsheet.draw.shouldDrawCell(cell)) {\n                return;\n            }\n            var left = cell.left;\n            var top = cell.top;\n            var width = cell.width + 1;\n            var height = cell.height + 1;\n            var style = {};\n            var background = cell.background;\n            var defaultBorder = null;\n            if (background) {\n                defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderLeft) {\n                style.borderLeft = cellBorder(cell.borderLeft);\n                if (vBorders) {\n                    vBorders[cell.left] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.left]) {\n                style.borderLeft = defaultBorder;\n            } else {\n                left++;\n                width--;\n            }\n            if (cell.borderTop) {\n                style.borderTop = cellBorder(cell.borderTop);\n                if (hBorders) {\n                    hBorders[cell.top] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.top]) {\n                style.borderTop = defaultBorder;\n            } else {\n                top++;\n                height--;\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n                if (vBorders) {\n                    vBorders[cell.right] = true;\n                }\n            } else if (defaultBorder && vBorders && !vBorders[cell.right]) {\n                style.borderRight = defaultBorder;\n            } else {\n                width--;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n                if (hBorders) {\n                    hBorders[cell.bottom] = true;\n                }\n            } else if (defaultBorder && hBorders && !hBorders[cell.bottom]) {\n                style.borderBottom = defaultBorder;\n            } else {\n                height--;\n            }\n            style.left = left + 'px';\n            style.top = top + 'px';\n            style.width = width + 'px';\n            style.height = height + 'px';\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [maybeLink(data)]);\n            } else {\n                data = maybeLink(data);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation._getOptions().messageTemplate;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation._getOptions().messageTemplate;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, { messages: kendo.spreadsheet.messages.view }, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n            },\n            enableClipboard: function (enable) {\n                this.isClipboardDeactivated = !enable;\n                if (enable) {\n                    this.clipboard.attr('contenteditable', enable);\n                } else {\n                    this.clipboard.removeAttr('contenteditable');\n                }\n            },\n            _resize: function () {\n                var tabstripHeight = this.tabstrip ? this.tabstrip.element.outerHeight() : 0;\n                var formulaBarHeight = this.formulaBar ? this.formulaBar.element.outerHeight() : 0;\n                var sheetsBarHeight = this.sheetsbar ? this.sheetsbar.element.outerHeight() : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var formulaBar = $('<div />').prependTo(this.element);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), $.extend(true, {}, this.options.sheetsbar));\n                }\n            },\n            _tabstrip: function () {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._workbook.execute(e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                x -= this._sheet._grid._headerWidth;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var right = rectangle.right - this.scroller.scrollLeft;\n                return right - handleWidth <= x && x <= right + handleWidth;\n            },\n            isRowResizer: function (y, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                y -= this._sheet._grid._headerHeight;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var bottom = rectangle.bottom - this.scroller.scrollTop;\n                return bottom - handleWidth <= y && y <= bottom + handleWidth;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var result = false;\n                x -= this._sheet._grid._headerWidth - this.scroller.scrollLeft;\n                y -= this._sheet._grid._headerHeight - this.scroller.scrollTop;\n                this._sheet.forEachFilterHeader(ref, function (ref) {\n                    var rect = this._rectangle(pane, ref);\n                    result = result || pane.filterIconRect(rect).intersects(x, y);\n                }.bind(this));\n                return result;\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    var row = pane._grid.rows.index(y, this.scroller.scrollTop);\n                    var column = pane._grid.columns.index(x, this.scroller.scrollLeft);\n                    var type = 'cell';\n                    var ref = new CellRef(row, column);\n                    var selecting = this._sheet.selectionInProgress();\n                    if (this.isAutoFill(x, y, pane)) {\n                        type = 'autofill';\n                    } else if (this.isFilterIcon(x, y, pane, ref)) {\n                        type = 'filtericon';\n                    } else if (!selecting && x < grid._headerWidth) {\n                        ref = new CellRef(row, -Infinity);\n                        type = this.isRowResizer(y, pane, ref) ? 'rowresizehandle' : 'rowheader';\n                    } else if (!selecting && y < grid._headerHeight) {\n                        ref = new CellRef(-Infinity, column);\n                        type = this.isColumnResizer(x, pane, ref) ? 'columnresizehandle' : 'columnheader';\n                    }\n                    object = {\n                        type: type,\n                        ref: ref\n                    };\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft), theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop));\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openDialog: function (name, options) {\n                var sheet = this._sheet;\n                var ref = sheet.activeCell();\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                if (dialog) {\n                    dialog.bind('action', this._executeCommand.bind(this));\n                    dialog.bind('deactivate', this._destroyDialog.bind(this));\n                    this._dialogs.push(dialog);\n                    dialog.open(range);\n                    return dialog;\n                }\n            },\n            showError: function (options, callback) {\n                var errorMessages = this.options.messages.errors;\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    this.openDialog(options.type, { close: callback });\n                } else {\n                    this.openDialog('message', {\n                        title: options.title || 'Error',\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: function (e) {\n                            e.sender.dialog().element.find('.k-button').focus();\n                        }.bind(this),\n                        close: callback\n                    });\n                }\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function () {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var resizeDirection = !sheet.resizingInProgress() ? 'none' : sheet.resizeHandlePosition().col === -Infinity ? 'column' : 'row';\n                this.wrapper.toggleClass(viewClassNames.editContainer, this.editor.isActive()).toggleClass(viewClassNames.horizontalResize, resizeDirection == 'row').toggleClass(viewClassNames.verticalResize, resizeDirection == 'column');\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                }, this);\n                var merged = [];\n                merged = Array.prototype.concat.apply(merged, result);\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                merged.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    merged.push(this.renderResizeHint());\n                }\n                this.tree.render(merged);\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!sheet.selectionInProgress() && !sheet.resizingInProgress() && !sheet.isInEditMode()) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = sheet.select().toRangeRef();\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var primaryMergedCells = {};\n                var secondaryMergedCells = {};\n                sheet.forEachMergedCell(selection, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primaryMergedCells[cellRef.print()] = ref;\n                        } else {\n                            secondaryMergedCells[cellRef.print()] = true;\n                        }\n                    });\n                });\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            columnResizeHandle: 'k-column-resize-handle',\n            rowResizeHandle: 'k-row-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    var ref = sheet._grid.normalize(sheet.resizeHandlePosition());\n                    if (view.ref.intersects(ref)) {\n                        if (!sheet.resizeHintPosition()) {\n                            children.push(this.renderResizeHandle());\n                        }\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(this._sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = this._sheet._showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px'\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px'\n                                }\n                            }));\n                        }\n                    });\n                }\n                var vBorders = {}, hBorders = {};\n                layout.cells.forEach(function (cell) {\n                    var hb = hBorders[cell.col] || (hBorders[cell.col] = {});\n                    var vb = vBorders[cell.row] || (vBorders[cell.row] = {});\n                    drawCell(cont.children, cell, null, hb, vb, showGridLines);\n                });\n                return cont;\n            },\n            renderResizeHandle: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [Pane.classNames.resizeHandle];\n                var style;\n                if (ref.col !== -Infinity) {\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n                return kendo.dom.element('div', {\n                    className: classNames.join(' '),\n                    style: style\n                });\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var activeCellClasses = [classNames.activeCell];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var activeFormulaColor = this._activeFormulaColor();\n                var selection = sheet.select();\n                activeCellClasses = activeCellClasses.concat(activeFormulaColor, this._directionClasses(activeCell));\n                selectionClasses = selectionClasses.concat(activeFormulaColor);\n                if (sheet.singleCellSelection()) {\n                    activeCellClasses.push(classNames.single);\n                }\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._addTable(selections, activeCell, activeCellClasses.join(' '));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _addTable: function (collection, ref, className) {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                if (view.ref.intersects(ref)) {\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        var rectangle = this._rectangle(ref);\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        drawCell(collection, cell, className, null, null, true);\n                    }.bind(this));\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                var clone = ref.clone();\n                clone.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                clone.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                return clone;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            adjust: function (start, delta) {\n                if (delta < 0) {\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    if (value === this._value) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var value = values[idx][field];\n                    var index = values[idx].index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    this.value(index, index, value);\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index, overflow) {\n                var end = this._count - 1;\n                if (index === end) {\n                    return overflow ? index + 1 : index;\n                }\n                index += 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.end === end) {\n                        return index - 1;\n                    } else {\n                        return range.end + 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index, overflow) {\n                if (index === 0) {\n                    return overflow ? -1 : 0;\n                }\n                index -= 1;\n                var range = this._hidden.intersecting(index, index)[0];\n                if (range.value !== 0) {\n                    if (range.start === 0) {\n                        return index + 1;\n                    } else {\n                        return range.start - 1;\n                    }\n                } else {\n                    return index;\n                }\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function (options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function (options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function (options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = 'num';\n            } else if (sections.length == 2) {\n                sections[0].cond = {\n                    op: '>=',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n            } else if (sections.length >= 3) {\n                sections[0].cond = {\n                    op: '>',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n                sections[2].cond = {\n                    op: '=',\n                    value: 0\n                };\n                if (sections.length > 3) {\n                    sections[3].cond = 'text';\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+)(?:,([#0?]+))+/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'time',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(am\\/pm|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            code += 'value = Math.abs(value); ';\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var CACHE = Object.create(null);\n    var TEXT = compileFormatPart({\n        cond: 'text',\n        body: [{ type: 'text' }]\n    });\n    function compile(format) {\n        var f = CACHE[format];\n        if (!f) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart);\n            code.push(TEXT);\n            code = code.join('\\n');\n            code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n            f = CACHE[format] = new Function('runtime', code)(runtime);\n        }\n        return f;\n    }\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += fraction.toFixed(fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = value.toFixed(declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        add(value.charAt(iv--));\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = value.toFixed(declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return Math.min.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('max', function (numbers) {\n        return Math.max.apply(Math, numbers);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$m1.width == $m2.width'\n                    ],\n                    [\n                        'assert',\n                        '$m1.height == $m2.height'\n                    ]\n                ]\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >> 1] + numbers[n >> 1 + 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                [\n                    'and',\n                    'number',\n                    [\n                        'not',\n                        'boolean'\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (ref, row, col, areanum) {\n        var m = ref instanceof UnionRef ? ref.refs[areanum - 1] : ref;\n        if (!row && !col || !m) {\n            return new CalcError('N/A');\n        }\n        m = this.asMatrix(m);\n        if (m.width > 1 && m.height > 1) {\n            if (row && col) {\n                return m.get(row - 1, col - 1);\n            }\n            if (!row) {\n                return m.mapRow(function (row) {\n                    return m.get(row, col - 1);\n                });\n            }\n            if (!col) {\n                return m.mapCol(function (col) {\n                    return m.get(row - 1, col);\n                });\n            }\n        }\n        if (m.width == 1) {\n            return m.get(row - 1, 0);\n        }\n        if (m.height == 1) {\n            return m.get(0, col - 1);\n        }\n        return new CalcError('REF');\n    }).args([\n        [\n            'range',\n            [\n                'or',\n                'matrix',\n                'ref'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else if (data === value) {\n                resultRow = row;\n                return true;\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function () {\n        var out = '';\n        for (var i = 0; i < arguments.length; ++i) {\n            out += arguments[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0.DECIMALS;($#,##0.DECIMALS)';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var format = noCommas ? '0.DECIMALS' : '#,##0.DECIMALS';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function () {\n        return this.text;\n    };\n    defineFunction('hyperlink', function (link, text) {\n        return new Hyperlink(link, text);\n    }).args([\n        [\n            '*link',\n            'string'\n        ],\n        [\n            '*text',\n            [\n                'or',\n                'string',\n                [\n                    'null',\n                    '$link'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue!'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            if (typeof a == 'string') {\n                return a.toLowerCase();\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return lc(a) != lc(b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border',\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        function withPreventDefault(f) {\n            return function (e) {\n                e.preventDefault();\n                return f.apply(this, arguments);\n            };\n        }\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', withPreventDefault(this.resetColor.bind(this)));\n                this.customColorButton.on('click', withPreventDefault(this.customColor.bind(this)));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + BORDER_PALETTE_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + BORDER_PALETTE_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-font-icon k-i-reset-color\\'></span>' + BORDER_PALETTE_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + BORDER_PALETTE_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', withPreventDefault(this._click.bind(this)));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-sprite k-font-icon k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            colorPicker: {\n                reset: 'Reset color',\n                customColor: 'Custom color...'\n            },\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            toggleGridlines: 'Toggle gridlines',\n            sortAsc: 'Sort ascending',\n            sortDesc: 'Sort descending',\n            sortButtons: {\n                sortSheetAsc: 'Sort sheet A to Z',\n                sortSheetDesc: 'Sort sheet Z to A',\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...',\n            hyperlink: 'Link'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'hyperlink',\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter',\n                'toggleGridlines'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'xlsa'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'xlsa'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decrease-decimal'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'increase-decimal'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'justify-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'background'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'text'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'text'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'format-number'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'merge-cells'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'freeze-panes'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'all-borders'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            hyperlink: {\n                type: 'dialog',\n                dialogName: 'hyperlink',\n                iconClass: 'hyperlink',\n                overflow: 'never',\n                text: ''\n            },\n            toggleGridlines: {\n                type: 'button',\n                command: 'GridLinesChangeCommand',\n                property: 'gridLines',\n                value: true,\n                iconClass: 'no-borders',\n                togglable: true\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'add-column-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'add-column-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'add-row-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'add-row-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'delete-column'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'delete-row'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-font-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        splitButton: { spriteCssClass: spriteCssClass },\n                        button: { showText: 'overflow' },\n                        colorPicker: { toolIcon: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        spriteCssClass: spriteCssClass,\n                        attributes: { title: MESSAGES[options.name || toolName] }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (property == 'gridLines') {\n                        value = range.sheet().showGridLines();\n                    }\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().map(function (element) {\n                    element = $(element);\n                    return {\n                        property: element.attr('data-property'),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    this.toolbar.dialog({ name: popupName });\n                } else {\n                    this.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-s\\'></span>' + '</a>');\n                this.element.on('click', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function (ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this.element = $('<button class=\\'k-button k-button-icon\\' title=\\'' + options.attributes.title + '\\'>' + '<span class=\\'k-icon k-font-icon k-i-xls\\' />' + '</button>').data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    property: 'textAlign',\n                    value: 'left',\n                    iconClass: 'justify-left',\n                    text: MESSAGES.alignmentButtons.justtifyLeft\n                },\n                {\n                    property: 'textAlign',\n                    value: 'center',\n                    iconClass: 'justify-center',\n                    text: MESSAGES.alignmentButtons.justifyCenter\n                },\n                {\n                    property: 'textAlign',\n                    value: 'right',\n                    iconClass: 'justify-right',\n                    text: MESSAGES.alignmentButtons.justifyRight\n                },\n                {\n                    property: 'textAlign',\n                    value: 'justify',\n                    iconClass: 'justify-full',\n                    text: MESSAGES.alignmentButtons.justifyFull\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'top',\n                    iconClass: 'align-top',\n                    text: MESSAGES.alignmentButtons.alignTop\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'center',\n                    iconClass: 'align-middle',\n                    text: MESSAGES.alignmentButtons.alignMiddle\n                },\n                {\n                    property: 'verticalAlign',\n                    value: 'bottom',\n                    iconClass: 'align-bottom',\n                    text: MESSAGES.alignmentButtons.alignBottom\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n                element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    element.find('[data-property=textAlign][data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    element.find('[data-property=verticalAlign][data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'cells',\n                    iconClass: 'merge-cells',\n                    text: MESSAGES.mergeButtons.mergeCells\n                },\n                {\n                    value: 'horizontally',\n                    iconClass: 'merge-horizontally',\n                    text: MESSAGES.mergeButtons.mergeHorizontally\n                },\n                {\n                    value: 'vertically',\n                    iconClass: 'merge-vertically',\n                    text: MESSAGES.mergeButtons.mergeVertically\n                },\n                {\n                    value: 'unmerge',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.mergeButtons.unmerge\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            buttons: [\n                {\n                    value: 'panes',\n                    iconClass: 'freeze-panes',\n                    text: MESSAGES.freezeButtons.freezePanes\n                },\n                {\n                    value: 'rows',\n                    iconClass: 'freeze-row',\n                    text: MESSAGES.freezeButtons.freezeRows\n                },\n                {\n                    value: 'columns',\n                    iconClass: 'freeze-col',\n                    text: MESSAGES.freezeButtons.freezeColumns\n                },\n                {\n                    value: 'unfreeze',\n                    iconClass: 'normal-layout',\n                    text: MESSAGES.freezeButtons.unfreeze\n                }\n            ],\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-font-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-font-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-font-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.remove('input');\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.trigger('action', { action: action });\n                }.bind(this));\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo-large',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo-large',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\'><span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('title').toLowerCase();\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', this.quickAccessToolBar.outerWidth());\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' },\n            linkDialog: {\n                title: 'Hyperlink',\n                labels: {\n                    text: 'Text',\n                    url: 'Address',\n                    removeLink: 'Remove link'\n                }\n            }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function (name) {\n                return !!registry[name];\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            options: { autoFocus: true },\n            dialog: function () {\n                if (!this._dialog) {\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({ messages: kendo.spreadsheet.messages.dialogs || MESSAGES })).appendTo(document.body).kendoWindow({\n                        autoFocus: this.options.autoFocus,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    }).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close');\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, info.symbol);\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'justify-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'justify-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'justify-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'justify-full',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'merge-cells',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'normal-layout',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'freeze-panes',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'freeze-row',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'freeze-col',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'normal-layout',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 420,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-warning\"> </span>' + '#= message #<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.start #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.end #\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.ignoreBlank #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label class=\"k-checkbox-label\" for=\"ignoreBlank\"></label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-action-buttons\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.showHint #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\"></label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">#: messages.remove #</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">#: messages.apply #</button>' + '<button class=\"k-button\" data-bind=\"click: close\">#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.exportAsDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                    }\n                });\n                kendo.bind(this.dialog().element, this.viewModel);\n            },\n            options: {\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' /><label class=\\'k-orientation-label k-orientation-portrait-label\\' for=\\'k-orientation-portrait\\'></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' /><label class=\\'k-orientation-label k-orientation-landscape-label\\' for=\\'k-orientation-landscape\\'></label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\' data-bind=\\'css: {k-page-landscape: pdf.landscape}\\'>' + '<div class=\\'k-margins-horizontal\\'></div>' + '<div class=\\'k-margins-vertical\\'></div>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.save #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        var ModifyMergedDialog = MessageDialog.extend({ options: { messageId: 'modifyMergedDialog.errorMessage' } });\n        kendo.spreadsheet.dialogs.register('modifyMerged', ModifyMergedDialog);\n        var OverflowDialog = MessageDialog.extend({ options: { messageId: 'overflowDialog.errorMessage' } });\n        kendo.spreadsheet.dialogs.register('overflow', OverflowDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.useKeyboardDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n            },\n            options: { template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var UnsupportedSelectionDialog = MessageDialog.extend({ options: { messageId: 'unsupportedSelectionDialog.errorMessage' } });\n        kendo.spreadsheet.dialogs.register('unsupportedSelection', UnsupportedSelectionDialog);\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.linkDialog.labels.url #:</label></div>' + '<div class=\\'k-edit-field\\'><input class=\\'k-textbox\\' data-bind=\\'value: url\\' /></div>' + '<div class=\\'k-action-buttons\\'>' + ('<button style=\\'float: left\\' class=\\'k-button\\' data-bind=\\'click: remove\\'>#= messages.linkDialog.labels.removeLink #</button>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#= messages.okText #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button>') + '</div>',\n                title: MESSAGES.linkDialog.title,\n                autoFocus: false\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function () {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger('action', {\n                            command: 'HyperlinkCommand',\n                            options: { link: model.url }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('input').focus().on('keydown', function (ev) {\n                    if (ev.keyCode == 13) {\n                        model.url = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('hyperlink', HyperlinkDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var identity = function (o) {\n            return o;\n        };\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = $.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this._boundRowsCount = 0;\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.insertRow) {\n                    this._sheetInsertRow(e.insertRow);\n                } else if (e.deleteRow) {\n                    this._sheetDeleteRow(e.deleteRow);\n                } else if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var fields;\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    var getters = columns.map(function (column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == 'date') {\n                            return kendo.spreadsheet.numberToDate;\n                        }\n                        return identity;\n                    });\n                    this._skipRebind = true;\n                    var values = this.sheet.range(e.ref).values();\n                    e.ref.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, getters[ci](values[valueIndex][colValueIndex++]));\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._boundRowsCount = dataSource.view().length;\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    var length = Math.max(data.length, this._boundRowsCount);\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n                this._boundRowsCount = data.length;\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon k-font-icon',\n            iconCollapse: 'k-i-collapse-se',\n            iconExpand: 'k-i-expand-e',\n            iconSearch: 'k-i-search',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-font-icon k-i-search\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-font-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var anyVisibleChildren = filter(item.children, itemVisible || query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                item.checked = !item.hidden;\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                uncheckAll(dataSource);\n                filter(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: true,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    if (sheet.isHiddenRow(row)) {\n                        return;\n                    }\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n                    if (value === undefined) {\n                        dataType = 'blank';\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == 'blank' ? messages.blanks : value;\n                    }\n                    if (dataType === 'percent') {\n                        dataType = 'number';\n                    }\n                    if (dataType === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: true\n                    });\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.blanks || valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('focus', this._focus.bind(this));\n                this.cellInput.bind('focus', this._focus.bind(this));\n                this.barInput.bind('blur', this._blur.bind(this));\n                this.cellInput.bind('blur', this._blur.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _focus: function (e) {\n                this.lastActive = e.sender == this.barInput ? 'bar' : 'cell';\n            },\n            _blur: function () {\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = options.range.topLeft;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function () {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                if (cellInput.value() != this._value) {\n                    if (this.trigger('change', { value: cellInput.value() })) {\n                        return;\n                    }\n                }\n                this._active = false;\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n            enableEditing: function (enable) {\n                this.barInput.enableEditing(enable);\n                this.cellInput.enableEditing(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focusLastActive: function () {\n                this.focus(this.lastActive);\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n            },\n            insertNewline: function () {\n                this.activeEditor().insertNewline();\n                this.scale();\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var MSG_INCOMPATIBLE = 'Incompatible ranges in fillFrom';\n    var MSG_NO_DIRECTION = 'Cannot determine fill direction';\n    var MSG_READ_ONLY = 'Destination range contains disabled cells';\n    var FillError = Range.FillError = function (msg) {\n        this.msg = msg;\n    };\n    FillError.prototype.toString = function () {\n        return this.msg;\n    };\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef();\n        var dest = destRange._ref.toRangeRef();\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(MSG_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(MSG_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(MSG_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(MSG_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new FillError(MSG_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        if (!x.dest.enable()) {\n            throw new FillError(MSG_READ_ONLY);\n        }\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                if (values.length == 1 && (begin > 0 || end < data.length || formatType(values[0], properties[begin].format) == 'date')) {\n                    values.push(values[0] + 1);\n                }\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function formatType(value, format) {\n        if (format != null) {\n            return spreadsheet.formatting.type(value, format);\n        }\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight) {\n        var curr = 0;\n        var out = [];\n        var threshold = 0.2 * pageHeight;\n        var bottom = pageHeight;\n        heights.forEach(function (h) {\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < threshold) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight);\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function getMergedCells(sheet, range) {\n        var grid = sheet._grid;\n        var primary = {};\n        var secondary = {};\n        sheet.forEachMergedCell(range, function (ref) {\n            var topLeft = ref.topLeft;\n            grid.forEach(ref, function (cellRef) {\n                if (topLeft.eq(cellRef)) {\n                    primary[cellRef.print()] = ref;\n                } else if (range.contains(cellRef)) {\n                    secondary[cellRef.print()] = topLeft;\n                }\n            });\n        });\n        return {\n            primary: primary,\n            secondary: secondary\n        };\n    }\n    function doLayout(sheet, range, options) {\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = getMergedCells(sheet, range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row) || !rh || !cw) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = options.pageWidth;\n        var pageHeight = options.pageHeight;\n        var scaleFactor = 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n                pageWidth /= scaleFactor;\n                pageHeight /= scaleFactor;\n            }\n        }\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.height();\n                cell.rowspan = ref.width();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cells.push(cell);\n                }\n            });\n        });\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(normalOrder),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderTop != null || cell.borderRight != null || cell.borderBottom != null || cell.borderLeft != null;\n    }\n    function normalOrder(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function drawLayout(layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = options.pageWidth / layout.scale;\n        var pageHeight = options.pageHeight / layout.scale;\n        for (var i = 0; i < ncols; ++i) {\n            for (var j = 0; j < nrows; ++j) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                page.clip(drawing.Path.fromRect(new geo.Rect([\n                    0,\n                    0\n                ], [\n                    options.pageWidth,\n                    options.pageHeight\n                ])));\n                var content = new drawing.Group();\n                page.append(content);\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke('#999', GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = new drawing.Group();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, borders, options);\n                });\n                content.append(borders);\n            }\n        }\n    }\n    function drawCell(cell, content, borders, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2;\n                r2d2.size.width -= GUIDELINE_WIDTH;\n                r2d2.size.height -= GUIDELINE_WIDTH;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        if (cell.borderLeft) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.left, cell.bottom).close().stroke(cell.borderLeft.color, cell.borderLeft.size));\n        }\n        if (cell.borderTop) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.top).lineTo(cell.right, cell.top).close().stroke(cell.borderTop.color, cell.borderTop.size));\n        }\n        if (cell.borderRight) {\n            borders.append(new drawing.Path().moveTo(cell.right, cell.top).lineTo(cell.right, cell.bottom).close().stroke(cell.borderRight.color, cell.borderRight.size));\n        }\n        if (cell.borderBottom) {\n            borders.append(new drawing.Path().moveTo(cell.left, cell.bottom).lineTo(cell.right, cell.bottom).close().stroke(cell.borderBottom.color, cell.borderBottom.size));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f;\n            if (cell.format) {\n                f = formatting.textAndColor(val, cell.format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    function drawText(text, color, cell, group) {\n        var rect_left = cell.left + 2;\n        var rect_top = cell.top + 2;\n        var rect_width = cell.width - 4;\n        var rect_height = cell.height - 4;\n        var font = makeFontDef(cell);\n        var style = { font: font };\n        var props = {\n            font: font,\n            fill: { color: color }\n        };\n        var lines = [], text_height = 0, top = rect_top;\n        if (cell.wrap) {\n            lineBreak(text, style, rect_width).forEach(function (line) {\n                var tmp = new drawing.Text(line.text, [\n                    rect_left,\n                    top\n                ], props);\n                top += line.box.height;\n                lines.push({\n                    el: tmp,\n                    box: line.box\n                });\n            });\n            text_height = top - rect_top;\n        } else {\n            var tmp = new drawing.Text(text, [\n                rect_left,\n                top\n            ], props);\n            var box = kendo.util.measureText(text, style);\n            lines.push({\n                el: tmp,\n                box: box\n            });\n            text_height = box.height;\n        }\n        var cont = new drawing.Group();\n        group.append(cont);\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = rect_height - text_height >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = rect_height - text_height;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        lines.forEach(function (line) {\n            cont.append(line.el);\n            var htrans = 0;\n            switch (cell.textAlign) {\n            case 'center':\n                htrans = rect_width - line.box.width >> 1;\n                break;\n            case 'right':\n                htrans = rect_width - line.box.width;\n                break;\n            }\n            if (htrans < 0) {\n                htrans = 0;\n            }\n            if (htrans || vtrans) {\n                line.el.transform(geo.Matrix.translate(htrans, vtrans));\n            }\n        });\n    }\n    function lineBreak(text, style, width) {\n        var lines = [];\n        var len = text.length;\n        var start = 0;\n        while (start < len) {\n            split(start, len, len);\n        }\n        return lines;\n        function split(min, eol, max) {\n            var sub = text.substring(start, eol).trim();\n            var box = kendo.util.measureText(sub, style);\n            if (box.width <= width) {\n                if (eol < max - 1) {\n                    split(eol, eol + max >> 1, max);\n                } else {\n                    lines.push({\n                        text: sub,\n                        box: box\n                    });\n                    start = eol;\n                }\n            } else if (min < eol) {\n                split(min, min + eol >> 1, eol);\n            }\n        }\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            emptyCells: true,\n            fitWidth: false,\n            center: false\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right;\n            pageHeight -= paper.margin.top + paper.margin.bottom;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    spreadsheet.draw = {\n        doLayout: doLayout,\n        drawLayout: drawLayout,\n        shouldDrawCell: shouldDrawCell\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this.refresh();\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render();\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                messages: {},\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                }\n            },\n            events: [\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'change',\n                'render'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"],"sourceRoot":"/source/"}